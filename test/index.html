<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><title>Firefox video paint stats</title></head>
<script src="../video-stats.js"></script>
<body>
  <p>Demonstration of the Firefox video paint statistics. Requires recent <a href="http://ftp.mozilla.org/pub/mozilla.org/firefox/nightly/latest-trunk/">Firefox nightly</a>, (or Firefox 5 once it ships!)</p>

  <video tabindex="0" src="http://videos.mozilla.org/serv/webmademovies/buttercamp.ogv" id="v" controls="controls" autoplay="autoplay"></video>

  <div id="log">
  <div>Decoded frames: <span id="decodedFrames"></span> p/s</div>
  <div>Parsed frames: <span id="parsedFrames"></span> p/s</div>
  <div>Painted frames: <span id="paintedFrames"></span> p/s</div>
  <div>Presented frames: <span id="presentedFrames"></span> p/s</div>
  <div>Delay Sum: <span id="delaySum"></span></div>
  <div>Delay Count: <span id="delayCount"></span></div>
  <div>Decoded Per Sec: <span id="decodedPerSec"></span> p/s</div>
  <div>Parsed Per Sec: <span id="parsedPerSec"></span> p/s</div>
  <div>Presented Per Sec: <span id="presentedPerSec"></span> p/s</div>
  <div>Painted Per Sec: <span id="paintedPerSec"></span> p/s</div>
  <div>Delay Mean: <span id="delayMean"></span></div>
  <div>Parps Mean: <span id="parpsMean"></span></div>
  <div>Dedps Mean: <span id="dedpsMean"></span></div>
  <div>Preps Mean: <span id="prepsMean"></span></div>
  <div>Pntps Mean: <span id="pntpsMean"></span></div>
  </div>

<script>

document.addEventListener('DOMContentLoaded', function() {

  var v = window.videoStatsObjects[0];

  function update(s, callToString) {
    document.getElementById(s).innerHTML = callToString ? v[s].toString() : v[s];
  }

  setInterval(function() {
    update('decodedFrames', false);
    update('parsedFrames', false);
    update('paintedFrames', false);
    update('presentedFrames', false);
    update('delaySum', false);
    update('delayCount', false);
    update('decodedPerSec', false);
    update('parsedPerSec', false);
    update('presentedPerSec', false);
    update('paintedPerSec', false);
    update('delayMean', true);
    update('parpsMean', true);
    update('dedpsMean', true);
    update('prepsMean', true);
    update('pntpsMean', true);
  }, 1000);

}, false);

</script>
</body></html>
